<!--
  Generated template for the ConversationsPage page.

  See http://ionicframework.com/docs/v2/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar>
    <button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>Messages</ion-title>
  </ion-navbar>
</ion-header>
<ion-content padding>
  <ion-card *ngFor="let conversation of conversations" class="shiftPostingCard"
            [hidden]="conversation.messages.length == 0">

    <ion-item style="margin-right:5px;margin-top:5px;cursor:pointer" (click)="toggleConversation(conversation)">
      <p item-left>
        {{conversation.post.shift | momentToString}}
        ({{conversation.post.platoon}})
      </p>
      <button small clear (click)="showConversationOptions(conversation)" item-right>
        <ion-icon name="options"></ion-icon>
      </button>
      <button small clear (click)="replyToConversation(conversation,$event)" item-right>
        <ion-icon name="share-alt"></ion-icon>
      </button>
    </ion-item>

    <ion-item *ngFor="let message of conversation.messages" [hidden]="conversation.collapsed">
      <ion-avatar item-left [hidden]="message.sender != conversation.creator.id">
        <img src="{{conversation.creator.photo}}"/>
        <img [hidden]="message.sender != conversation.recipient.id" src="{{conversation.recipient.photo}}"/>
      </ion-avatar>
      <ion-avatar item-right [hidden]="message.sender != conversation.recipient.id">
        <img src="{{conversation.recipient.photo}}"/>
      </ion-avatar>
      <ion-item text-wrap> {{message.content}}</ion-item>
    </ion-item>
  </ion-card>
</ion-content>
